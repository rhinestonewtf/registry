// SPDX-License-Identifier: MIT
pragma solidity ^0.8.24;

import { Script } from "forge-std/Script.sol";
import { IExternalResolver } from "../src/external/IExternalResolver.sol";
import { ResolverUID } from "../src/DataTypes.sol";
import { console2 } from "forge-std/console2.sol";

/**
 * @title DeployRegistryScript
 * @author zeroknots
 */
contract DeployRegistryScript is Script {
    function run() public {
        bytes32 salt = bytes32(uint256(2));

        vm.startBroadcast(vm.envUint("PK"));

        // Deploy Registry
        RegistryInstance memory instance = _setupInstance({ name: "Registry", salt: salt });

        // Set up default resolver
        DebugResolver debugResolver = new DebugResolver{ salt: salt }(address(instance.registry));
        instance.registry.registerResolver(IExternalResolver(address(debugResolver)));

        vm.stopBroadcast();
    }
}
